experiment_name: "von_mises_test"

data:
  type: "synthetic"   # Options: synthetic, csv
  symmetry: true      # Set to true to enforce s12>=0, false for full range
  samples:
    loci: 200         # For shape/convexity (Mask=0)
    uniaxial: 100     # For R-values (Mask=1)
  input_range: [-2.0, 2.0]

dynamic_convexity:
  enabled: true
  samples: 1000        # How many random points to probe per step
  interval: 50       # Run dynamic check every N steps (0 = every step)

symmetry:
  enabled: true
  samples: 100        # Number of equator points
  interval: 100       # Run every N steps (0 = every step)

anisotropy_ratio:
  enabled: true
  batch_r_fraction: 0.1  # Fraction of batch for R-value data
  interval: 50           # Run every N steps (0 = every step)

model:
  hidden_layers: [32, 16, 8]
  activation: "softplus" # Must be smooth (no ReLU)
  ref_stress: 1.0
  use_icnn_constraints: false # Enforce ICNN constraints for convexity

physics:  # synthetic Hill48 parameters
  # F: 3.5
  # G: 3.8
  # H: 1.55
  # N: 3.25
  F: 0.5
  G: 0.5
  H: 0.5
  N: 1.5

training:
  k_folds: 1
  epochs: 100000
  batch_size: 16
  learning_rate: 0.001
  save_dir: "outputs"
  checkpoint_interval: 100

  # --- STOPPING SWITCHES ---
  # Training stops ONLY when ALL enabled thresholds are met.
  # Set to null (or remove) to disable specific checks.
  loss_threshold: 0.00005       # Main Stop: Total Loss (Stress + others)
  convexity_threshold: 0.0005  # Safety Net: Max allowed negative eigenvalue
  gnorm_threshold: 0.005        # Stability: Max allowed gradient norm | NOTE: There is no weight-loss directly connected to this switch.
  r_threshold: 0.01            # Accuracy: Max allowed R-value error (approx 5%)

  weights:
    stress: 1.0
    r_value: 0.1          # Weight for R-value data
    convexity: 1.0       # Weight for static data convexity
    dynamic_convexity: 1.0 # Weight for dynamic self-consistent convexity
    symmetry: 0.01        # Penalty for non-zero shear slope at equator