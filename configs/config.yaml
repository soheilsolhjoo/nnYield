experiment_name: "vonMises_benchmark_v1"

# ==============================================================================
#  1. DATA GENERATION (src/data_loader.py)
# ==============================================================================
data:
  # These fields are needed by src/config.py validation
  type: "synthetic"        # We use internal synthetic generation (Hill48)
  input_range: [-2.0, 2.0] # Defines the bounds of the normalized stress space
  
  # Symmetry: If true, generates points only in the first quadrant (0-90 degrees).
  # If false, generates for the full domain (0-360 degrees).
  symmetry: true
  
  samples:
    # Loci: Random points scattered on the yield surface (for general shape learning)
    loci: 200
    # Uniaxial: Points along specific loading paths (for R-value/Slope learning)
    uniaxial: 20

# ==============================================================================
#  2. PHYSICS & ANISOTROPY (src/losses.py & src/data_loader.py)
# ==============================================================================
physics:
  # The "Ground Truth" Hill48 parameters the model tries to learn.
  # (Corresponds to a synthetic material)
  F: 0.5
  G: 0.5
  H: 0.5
  N: 1.5
    # Alternative anisotropic set
  # F: 3.5
  # G: 3.8
  # H: 1.55
  # N: 3.25


anisotropy_ratio:
  # Dual Stream Strategy:
  # If enabled, the trainer mixes "General Shape" data with "Physics/R-value" data.
  enabled: true
  
  # How much of each batch is dedicated to Physics points?
  # 0.25 means 25% of the batch is uniaxial data (for R-values), 75% is random (for shape).
  batch_r_fraction: 0.25

# ==============================================================================
#  3. MODEL ARCHITECTURE (src/model.py)
# ==============================================================================
model:
  hidden_layers: [32, 16, 8]  # Deeper networks often capture curvature better
  activation: "softplus"       # Must be smooth (C2 continuous) for Hessians. Do NOT use ReLU.
  ref_stress: 1.0              # Scaling factor (usually normalized yield stress)

# ==============================================================================
#  4. LOSS WEIGHTS (src/losses.py)
# ==============================================================================
weights:
  # Accuracy: Matches the yield stress magnitude.
  stress: 1.0
  
  # Physics: Matches the plastic flow direction (R-values).
  # Set to 0.0 to disable physics-informed training.
  r_value: 1.0
  
  # Thermodynamics: Enforces convexity (Positive Definite Hessian).
  convexity: 0.1               # Static weight (constant throughout)
  dynamic_convexity: 10.0       # Target weight (ramps up during warmup)
  
  # Symmetry: Enforces Model(S12) == Model(-S12)
  symmetry: 0.1

# ==============================================================================
#  5. TRAINING LOOP (src/trainer.py)
# ==============================================================================
training:
  epochs: 5000
  batch_size: 32
  learning_rate: 0.001
  save_dir: "outputs"
  
  # Logging & Checkpointing
  print_interval: 50           # Print status to terminal every N epochs
  save_interval: 100           # Save checkpoint every N epochs
  overwrite: true              # If true, deletes existing experiment folder
  
  # Curriculum Learning
  # Linearly ramp up the 'dynamic_convexity' weight from 0 to target
  # over the first N epochs. Helps the model learn the shape first, then refine curvature.
  convexity_warmup: 500

  # Early Stopping Criteria
  # Training stops if ALL enabled metrics are met.
  # Remove or set to null to disable a specific check.
  stop_metrics:
    total_loss: 0.005         # Stop if Total Loss < X
    r_error: 0.02              # Stop if Mean R-value Error < X (e.g. 2%)
    
    # Convexity Check (Minimum Eigenvalue of Hessian)
    # A perfectly convex surface has Min Eig >= 0.
    # We allow a tiny tolerance (e.g., -1e-4) for numerical noise.
    # Stop if Min Eig >= -0.0001
    min_eig: -0.0002