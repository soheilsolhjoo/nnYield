experiment_name: "von_mises_benchmark"

# ==============================================================================
#  DATA
# ==============================================================================
data:
  type: "synthetic"
  input_range: [-2.0, 2.0]
  symmetry: true
  samples:
    loci: 200      # Training Batch: Random Shape Points
    uniaxial: 20   # Training Batch: Equidistant Physics Points

# ==============================================================================
#  PERIODIC CHECKS (Used As Intended)
# ==============================================================================
dynamic_convexity:
  enabled: true
  samples: 100    # Generate N FRESH points to test convexity
  interval: 1    # Run this specific test every 100 epochs

symmetry:
  enabled: true
  samples: 100     # Generate 100 FRESH equator points to test symmetry
  interval: 1    # Run this specific test every 100 epochs

anisotropy_ratio:
  enabled: true
  batch_r_fraction: 0.25
  interval: 1      # Mix physics data into training every N steps

# ==============================================================================
#  PHYSICS & MODEL
# ==============================================================================
physics:
  F: 0.5
  G: 0.5
  H: 0.5
  N: 1.5

model:
  hidden_layers: [32, 16, 8]
  activation: "softplus"
  ref_stress: 1.0
  use_icnn_constraints: false

# ==============================================================================
#  WEIGHTS
# ==============================================================================
weights:
  stress: 10.0
  r_value: 1.0
  symmetry: 0.1
  convexity: 0.1
  dynamic_convexity: 1.0

# ==============================================================================
#  TRAINING
# ==============================================================================
training:
  k_folds: 1
  epochs: 1000
  batch_size: 32
  learning_rate: 0.001
  save_dir: "outputs"
  
  checkpoint_interval: 100   # Restored name
  print_interval: 50
  overwrite: true
  
  convexity_warmup: 500
  r_warmup: 200

  # STOPPING THRESHOLDS (Original switches restored)
  loss_threshold: 0.005        # Stop if Total Loss < X
  r_threshold: 0.02            # Stop if R-error < X
  convexity_threshold: -0.0001 # Stop if Min Eig >= X
  # gnorm_threshold: null        # Disabled