# =============================================================================
# HIGH-LEVEL SETTINGS
# =============================================================================
experiment_name: "von_mises_benchmark"

# =============================================================================
# DATA PIPELINE
# =============================================================================
data:
  type: "synthetic"         # options: synthetic, csv
  positive_shear: true      # true: s12 >= 0 | false: full range [-max, max]
  input_range: [-1.0, 1.0]
  samples:
    loci: 200               # Random points for overall shape (Mask=0)
    uniaxial: 10            # Tension points for R-values (Mask=1)

# =============================================================================
# PHYSICS & CONSTRAINTS (The Material Model)
# =============================================================================
physics:
  # synthetic Hill48 parameters (Hill 1948)
  # F: 0.5
  # G: 0.5
  # H: 0.5
  # N: 1.5
  # Alternative anisotropic set
  F: 3.5
  G: 3.8
  H: 1.55
  N: 3.25

physics_constraints:
  anisotropy:
    enabled: true
    batch_r_fraction: 0.2   # percentage of batch dedicated to R-values
    interval: 10            # validate full path every N epochs
  
  orthotropy:
    enabled: true
    samples: 100            # number of equator points to probe
    interval: 50            # run penalty every N steps
    
  dynamic_convexity:
    enabled: true
    samples: 1000           # points probed across full surface
    interval: 100           # run penalty every N steps

# =============================================================================
# MODEL ARCHITECTURE
# =============================================================================
model:
  hidden_layers: [8, 8, 8, 8]
  activation: "softplus"    # smooth activation required for Hessian
  ref_stress: 1.0
  use_icnn_constraints: false

# =============================================================================
# TRAINING ENGINE
# =============================================================================
training:
  # Basic Loop
  epochs: 100000
  batch_size: 16
  learning_rate: 0.01
  k_folds: 1
  
  # Logging & Persistence
  save_dir: "outputs"
  checkpoint_interval: 100
  print_interval: 25
  overwrite: true

  # Curriculum Learning (Linear Weight Ramping)
  curriculum:
    r_warmup: 200           # Epochs to ramp anisotropy weight
    convexity_warmup: 500   # Epochs to ramp convexity weights

  # Dynamic Learning Rate
  lr_scheduler:
    enabled: true
    patience: 100           # epochs of no improvement
    factor: 0.9             # reduction multiplier
    min_lr: 1.0e-6

  # --- STOPPING THRESHOLDS ---
  # Training stops only when ALL enabled conditions are met.
  stopping_criteria:
    loss_threshold: 0.01       # Total objective
    r_threshold: 0.01          # Mean R-value error
    convexity_threshold: -1.0e-4 # Target for Min Eigenvalue
    gnorm_threshold: 0.01      # Stability (gradient norm)

  # --- LOSS WEIGHTS ---
  weights:
    # 1. Primary Accuracy
    stress: 1.0
    r_value: 2.0
    
    # 2. Curvature & Symmetry
    batch_convexity: 0.5
    dynamic_convexity: 0.5
    orthotropy: 1.0
    
    # 3. Numerical Health
    gnorm_penalty: 1.0