experiment_name: "von_mises_benchmark"

data:
  type: "synthetic"   # Options: synthetic, csv
  positive_shear: true      # Set to true to enforce s12>=0, false for full range
  samples:
    loci: 200         # For shape/convexity (Mask=0)
    uniaxial: 10     # For R-values (Mask=1)
  input_range: [-1.0, 1.0]

dynamic_convexity:
  enabled: true
  samples: 1000        # How many random points to probe per step
  interval: 10       # Run dynamic check every N steps (0 = every step)

orthotropy:
  enabled: true
  samples: 100        # Number of equator points
  interval: 10       # Run every N steps (0 = every step)

anisotropy:
  # This decides if we go for dual stream of single one
  enabled: true         # Enable R-value data loss
  batch_r_fraction: 0.2  # Fraction of batch for R-value data
  interval: 10           # Run every N steps (0 = every step)

model:
  hidden_layers: [8, 8, 8, 8]  # Number of neurons per hidden layer
  activation: "softplus" # Must be smooth (no ReLU)
  ref_stress: 1.0
  use_icnn_constraints: false # Enforce ICNN constraints for convexity

physics:  # synthetic Hill48 parameters
  # This set corresponds to a von Mises model
  F: 0.5
  G: 0.5
  H: 0.5
  N: 1.5
  # Alternative anisotropic set
  # F: 3.5
  # G: 3.8
  # H: 1.55
  # N: 3.25
  
training:
  k_folds: 1
  epochs: 30
  batch_size: 16
  learning_rate: 0.001
  save_dir: "outputs"
  checkpoint_interval: 100
  
  print_interval: 25
  # overwrite: true

  r_warmup: 200

  # --- STOPPING SWITCHES ---
  # Training stops ONLY when ALL enabled thresholds are met.
  # Set to null (or remove) to disable specific checks.
  loss_threshold: 0.01       # Main Stop: Total Loss (Stress + others)
  gnorm_threshold: 0.01        # Stability: Max allowed gradient norm | NOTE: There is no weight-loss directly connected to this switch.
  r_threshold: 0.01            # Accuracy: Max allowed R-value error (approx 5%)
  # convexity_threshold: Target for PHYSICAL MIN EIGENVALUE
  # Set this to the "Maximum Allowed Dent Depth".
  # Example: 2.0e-4 means "Stop only if Min Eigenvalue >= -0.0002"
  convexity_threshold: 2.0e-4

  weights:
    stress: 1.0
    r_value: 5.0          # Weight for R-value data
    batch_convexity: 1.0       # Weight for static data convexity
    dynamic_convexity: 1.0 # Weight for dynamic self-consistent convexity
    orthotropy: 0.1        # Penalty for non-zero shear slope at equator
    gnorm_penalty: 1.0   # Penalizes the magnitude of weight updates to ensure training stability and smooth loss landscapes.
    